<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <title>Demo Feature Flag ‚Äî Survey</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <!-- Bootstrap CSS (CDN) -->
  <link
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
    rel="stylesheet"
    integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
    crossorigin="anonymous"
  >
</head>
<body class="bg-light">
  <div class="container py-5">
    {% if survey_on %}
      <!-- ======= PANTALLA ON (Survey) ======= -->
      <div class="row justify-content-center">
        <div class="col-lg-7">
          <div class="card shadow-sm border-0">
            <div class="card-body p-4">
              <div class="d-flex align-items-start justify-content-between mb-3">
                <div>
                  <h1 class="h3 mb-1">Encuesta de Satisfacci√≥n</h1>
                  <p class="text-muted mb-0">
                    Esta encuesta es de demostraci√≥n (no env√≠a datos). Se controla con la Feature Flag <code>SurveyON</code>.
                  </p>
                </div>
                <span class="badge text-bg-primary align-self-start">Demo</span>
              </div>

              <form onsubmit="event.preventDefault(); mostrarToastGracias();">
                <!-- Nombre -->
                <div class="mb-3">
                  <label for="name" class="form-label">Nombre</label>
                  <input type="text" class="form-control" id="name" placeholder="Tu nombre" required>
                </div>

                <!-- Correo -->
                <div class="mb-3">
                  <label for="email" class="form-label">Correo</label>
                  <input type="email" class="form-control" id="email" placeholder="tucorreo@ejemplo.com" required>
                </div>

                <!-- Calificaci√≥n (1‚Äì5) -->
                <div class="mb-3">
                  <label class="form-label d-block">Calificaci√≥n general</label>
                  <div class="d-flex gap-2 flex-wrap">
                    <div class="form-check">
                      <input class="form-check-input" type="radio" name="rating" id="r1" value="1" required>
                      <label class="form-check-label" for="r1">1 - Muy mala</label>
                    </div>
                    <div class="form-check">
                      <input class="form-check-input" type="radio" name="rating" id="r2" value="2">
                      <label class="form-check-label" for="r2">2</label>
                    </div>
                    <div class="form-check">
                      <input class="form-check-input" type="radio" name="rating" id="r3" value="3">
                      <label class="form-check-label" for="r3">3 - Normal</label>
                    </div>
                    <div class="form-check">
                      <input class="form-check-input" type="radio" name="rating" id="r4" value="4">
                      <label class="form-check-label" for="r4">4</label>
                    </div>
                    <div class="form-check">
                      <input class="form-check-input" type="radio" name="rating" id="r5" value="5">
                      <label class="form-check-label" for="r5">5 - Excelente</label>
                    </div>
                  </div>
                </div>

                <!-- Experiencia -->
                <div class="mb-3">
                  <label class="form-label" for="experience">¬øQu√© tan f√°cil fue usar la app?</label>
                  <select class="form-select" id="experience" required>
                    <option value="" selected disabled>Selecciona una opci√≥n‚Ä¶</option>
                    <option>Muy dif√≠cil</option>
                    <option>Dif√≠cil</option>
                    <option>Neutral</option>
                    <option>F√°cil</option>
                    <option>Muy f√°cil</option>
                  </select>
                </div>

                <!-- √Åreas de inter√©s (checkbox) -->
                <div class="mb-3">
                  <label class="form-label d-block">¬øQu√© te gustar√≠a ver mejorado?</label>
                  <div class="row g-2">
                    <div class="col-sm-6">
                      <div class="form-check">
                        <input class="form-check-input" type="checkbox" id="perf">
                        <label class="form-check-label" for="perf">Rendimiento</label>
                      </div>
                    </div>
                    <div class="col-sm-6">
                      <div class="form-check">
                        <input class="form-check-input" type="checkbox" id="ui">
                        <label class="form-check-label" for="ui">Interfaz</label>
                      </div>
                    </div>
                    <div class="col-sm-6">
                      <div class="form-check">
                        <input class="form-check-input" type="checkbox" id="docs">
                        <label class="form-check-label" for="docs">Documentaci√≥n</label>
                      </div>
                    </div>
                    <div class="col-sm-6">
                      <div class="form-check">
                        <input class="form-check-input" type="checkbox" id="features">
                        <label class="form-check-label" for="features">Nuevas funciones</label>
                      </div>
                    </div>
                  </div>
                </div>

                <!-- Comentarios -->
                <div class="mb-4">
                  <label for="comments" class="form-label">Comentarios (opcional)</label>
                  <textarea id="comments" class="form-control" rows="4" placeholder="Cu√©ntanos tu experiencia o ideas"></textarea>
                </div>

                <div class="d-flex align-items-center gap-3">
                  <button type="submit" class="btn btn-primary px-4">Enviar</button>
                  <span class="text-muted small">(Demo: no se env√≠an datos)</span>
                </div>
              </form>
            </div>
          </div>

          <!-- Toast de agradecimiento (demo) -->
          <div class="position-fixed bottom-0 end-0 p-3" style="z-index: 1080">
            <div id="toastGracias" class="toast" role="status" aria-live="polite" aria-atomic="true">
              <div class="toast-header">
                <strong class="me-auto">¬°Gracias!</strong>
                <small>Demo</small>
                <button type="button" class="btn-close ms-2 mb-1" data-bs-dismiss="toast" aria-label="Cerrar"></button>
              </div>
              <div class="toast-body">
                Tu respuesta ha sido registrada (de mentira üòÑ). Esta pantalla aparece porque la Feature Flag <code>SurveyON</code> est√° <strong>ON</strong>.
              </div>
            </div>
          </div>
        </div>
      </div>
    {% else %}
      <!-- ======= PANTALLA OFF (Elegante) ======= -->
      <div class="row justify-content-center">
        <div class="col-lg-8">
          <div class="card border-0 shadow-sm overflow-hidden">
            <div class="row g-0">
              <!-- Lateral decorativo -->
              <div class="col-md-4 d-none d-md-block" style="
                  background: radial-gradient(120% 120% at 0% 0%, #e9f2ff 0%, #f8fbff 60%, #ffffff 100%);
              ">
                <div class="h-100 d-flex align-items-center justify-content-center p-4">
                  <!-- Toggle OFF SVG -->
                  <svg width="140" height="140" viewBox="0 0 200 100" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
                    <rect x="5" y="20" rx="30" ry="30" width="190" height="60" fill="#e9ecef"/>
                    <circle cx="55" cy="50" r="28" fill="#adb5bd"/>
                    <text x="100" y="56" text-anchor="middle" font-size="14" fill="#6c757d">OFF</text>
                  </svg>
                </div>
              </div>

              <!-- Contenido -->
              <div class="col-md-8">
                <div class="card-body p-4 p-lg-5">
                  <div class="d-flex align-items-center gap-2 mb-2">
                    <span class="badge text-bg-secondary">Feature Flag</span>
                    <code class="small">SurveyON</code>
                  </div>

                  <h1 class="h3 mb-2">La encuesta est√° desactivada</h1>
                  <p class="text-muted mb-4">
                    Esta secci√≥n se controla con una <em>feature flag</em>. Cuando <code>SurveyON</code> est√© <strong>ON</strong>,
                    ver√°s aqu√≠ el formulario de encuesta sin necesidad de redeploy.
                  </p>

                  <div class="d-flex flex-wrap gap-2">
                    <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#modalActivar">
                      ¬øC√≥mo activarla?
                    </button>
                    <button class="btn btn-outline-secondary" onclick="location.reload()">
                      Volver a comprobar
                    </button>
                  </div>

                  <hr class="my-4">

                  <div class="row g-3">
                    <div class="col-sm-6">
                      <div class="d-flex align-items-start gap-3">
                        <div class="fs-4">‚ö°</div>
                        <div>
                          <div class="fw-semibold">Cambios en caliente</div>
                          <div class="text-muted small">
                            Activa/Desactiva desde Azure y actualiza la p√°gina para ver el cambio.
                          </div>
                        </div>
                      </div>
                    </div>

                    <div class="col-sm-6">
                      <div class="d-flex align-items-start gap-3">
                        <div class="fs-4">üõ°Ô∏è</div>
                        <div>
                          <div class="fw-semibold">Seguro para producci√≥n</div>
                          <div class="text-muted small">
                            No afecta otras partes de la app cuando est√° OFF.
                          </div>
                        </div>
                      </div>
                    </div>

                    <div class="col-sm-6">
                      <div class="d-flex align-items-start gap-3">
                        <div class="fs-4">üß™</div>
                        <div>
                          <div class="fw-semibold">Pruebas controladas</div>
                          <div class="text-muted small">
                            Habilita la funci√≥n solo a quienes necesites (rollouts, A/B).
                          </div>
                        </div>
                      </div>
                    </div>

                    <div class="col-sm-6">
                      <div class="d-flex align-items-start gap-3">
                        <div class="fs-4">‚è±Ô∏è</div>
                        <div>
                          <div class="fw-semibold">Sin redeploy</div>
                          <div class="text-muted small">
                            La UI aparecer√° cuando la flag pase a ON.
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>

                  <div class="mt-4">
                    <span class="badge rounded-pill text-bg-light border">
                      Estado: <span class="ms-1 text-danger fw-semibold">OFF</span>
                    </span>
                  </div>
                </div>
              </div>
            </div> <!-- row -->
          </div> <!-- card -->
        </div>
      </div>

      <!-- Modal: pasos para activar -->
      <div class="modal fade" id="modalActivar" tabindex="-1" aria-labelledby="modalActivarLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
          <div class="modal-content">
            <div class="modal-header">
              <h2 class="modal-title fs-5" id="modalActivarLabel">Activar <code>SurveyON</code></h2>
              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
            </div>
            <div class="modal-body">
              <ol class="mb-0">
                <li>Abre <strong>Azure App Configuration</strong> &rarr; <em>Feature manager</em>.</li>
                <li>Busca la flag <code>SurveyON</code> y col√≥cala en <strong>ON</strong>.</li>
                <li>Vuelve a esta p√°gina y pulsa <em>Volver a comprobar</em> (o refresca el navegador).</li>
              </ol>
              <hr>
              <p class="small text-muted mb-0">
                Si usas clave <em>sentinel</em>, cambia su valor (p. ej. de <code>1</code> a <code>2</code>) y recarga para refrescar al instante.
              </p>
            </div>
            <div class="modal-footer">
              <button class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
              <button class="btn btn-primary" onclick="location.reload()">Volver a comprobar</button>
            </div>
          </div>
        </div>
      </div>
    {% endif %}
  </div>

  <!-- Bootstrap JS (bundle con Popper) -->
  <script
    src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
    crossorigin="anonymous">
  </script>

  <script>
    function mostrarToastGracias() {
      const toastEl = document.getElementById('toastGracias');
      if (toastEl && window.bootstrap) {
        const toast = new bootstrap.Toast(toastEl, { delay: 2500 });
        toast.show();
      } else {
        alert('¬°Gracias! (demo)');
      }
    }
  </script>
</body>
</html>
